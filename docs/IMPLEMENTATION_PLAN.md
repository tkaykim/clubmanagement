# 동아리 관리 플랫폼 — 구현 계획서

> 이 문서는 동아리 운영·관리 툴의 **전체 요구사항**과 **단계별 구현 계획**을 정의합니다.  
> 언급된 모든 기능은 필수 구현 대상이며, 필요 시 추가 아이디어를 반영합니다.

---

## 1. 역할(유저) 정의

| 역할 | 설명 | 권한 요약 |
|------|------|------------|
| **슈퍼관리자** | 플랫폼 전체 관리 | 모든 동아리/프로젝트 조회·수정·생성, 사용자·동아리 승인/정리, 시스템 설정 |
| **동아리 리더** | 동아리 운영자 | 동아리 생성·정보 수정, 회원 모집·관리, 프로젝트 생성·관리, 일정·할일 관리 |
| **동아리 회원** | 동아리 소속 회원 | 소속 동아리 목록, 모집 공고/프로젝트 조회·신청, 캘린더·일정 확인, 본인 참여 이력 |

- 동아리 리더는 **해당 동아리**에 한해 관리 권한을 가짐.  
- 슈퍼관리자는 **어떤 동아리**에도 리더급 이상 권한을 가질 수 있음(필요 시 “관리자 권한으로 동작” 옵션).

---

## 2. 핵심 도메인 요구사항 (필수)

### 2.1 동아리(Club)

- **생성**: 동아리 리더 또는 슈퍼관리자가 동아리 생성.
- **정보**: 이름, 설명, 대표 이미지, 카테고리(대분류–중분류–소분류), 연락처 등.
- **카테고리**: 댄스, 밴드, 운동 등 **대분류 → 중분류 → (필요 시) 소분류** 계층.
- **회원 모집**:
  - 모집 **열기/닫기** 토글.
  - **지원 마감 일시** 설정.
  - **지원자 목록** 조회(이름, 연락처, 지원 시각, 메모 등).
  - **수기 가입**: 리더/관리자가 회원을 직접 추가(이메일 또는 연락처로 유저 연결 또는 “비회원 회원” 생성).

### 2.2 동아리 회원(Member) 상태

- **활성**: 정상 활동 회원.
- **비활성**: 일시 휴면 등(활동 중단).
- **탈퇴**: 동아리 탈퇴 처리.

- 리더/관리자: 회원 목록 조회 시 **참여 프로젝트 목록**, **최근 참여 일자** 등 노출.

### 2.3 프로젝트(Project)

- **생성**: 동아리 리더 또는 슈퍼관리자(직접 생성 가능).
- **일정**: 프로젝트 **시작일·종료일** (및 필요 시 시간).
- **모집**:
  - **모집 기한**(날짜·시각) 설정.
  - 동아리 회원에게 **참가 신청** 받기.
- **구분**:
  - **유가형**: 매출 있는 프로젝트(수익 발생).
  - **무상**: 비용 없음.
  - **참가비형**: 회원이 내는 참가비 있는 프로젝트.
- **진행 상태**: **예정** / **진행 중** / **종료**.
- **참여 이력**: 프로젝트별 **누가 참여했는지** 목록 조회(리더·관리자·해당 프로젝트 참여자).

**할일(Task)**  
- 프로젝트 내 **할일** 생성: 제목, 담당자(동아리원 지정), **마감일**.  
- 예: “대관” — A에게 3/10까지, “촬영” — B에게 3/15까지.

**공개 범위**  
- **동아리만 공개**: 해당 동아리 회원만 보기·신청 가능.  
- **비공개**: 관계자만(또는 초대만).  
- **전체 공개**:  
  - 앱 내 다른 회원 + **비로그인 유저**도 볼 수 있음(예: 정기공연 홍보).  
  - **포스터 이미지**, **설명(본문)** 필수 포함.  
  - **관람 신청**:  
    - 무료 관람: 신청만 받고 입장/출석 관리.  
    - 유료 관람: **결제** 후 관람 신청, **출석 체크/입장 확인**으로 사용.

### 2.4 캘린더

- 유저는 **본인이 속한 동아리**와 관련된 일정을 캘린더에서 확인·관리.
- 일정: 프로젝트 일정, 모임, 마감일 등(동아리·프로젝트 단위로 필터 가능).

### 2.5 동아리 회원용 뷰(대시/피드)

- **내 동아리 목록**.
- **모집 중인 프로젝트** (마감 임박 등 표시).
- **마감 임박/진행 중** 프로젝트.
- **동아리 회원 모집 공고** (모집 중인 동아리 목록/카드).

---

## 3. 추가 제안 기능(선택·권장)

- **알림**: 모집 마감 D-day, 할일 마감일, 새 지원자, 관람 신청 등.
- **공지**: 동아리별 공지사항 게시(리더 작성, 회원 열람).
- **간단 설문/투표**: 일정·테마 등 회원 의견 수렴.
- **자료 공유**: 프로젝트별 파일/링크 모음(포스터, 영상 링크 등).
- **출석/참여 요약**: 회원별 “이번 달 참여 횟수”, “프로젝트 참여율” 등 리더 뷰.
- **검색/필터**: 동아리·프로젝트를 카테고리·공개 여부·상태로 검색.

---

## 4. 페이지/화면 구성 (필수 포함)

| 구분 | 경로(예시) | 설명 | 주요 사용자 |
|------|------------|------|-------------|
| **인증** | `/login`, `/signup`, `/reset-password` | 로그인·회원가입·비밀번호 재설정 | 전체 |
| **홈/랜딩** | `/` | 비로그인: 공개 프로젝트/동아리 소개, 로그인: 대시 진입 | 전체 |
| **슈퍼관리자** | `/admin/*` | 동아리/프로젝트/유저 전체 관리, 시스템 설정 | 슈퍼관리자 |
| **동아리 리더** | `/club/[id]/manage/*` | 동아리 설정, 회원·지원자, 프로젝트·할일·일정 관리 | 리더, (관리자) |
| **동아리 회원** | `/club/[id]`, `/club/[id]/projects`, `/club/[id]/calendar` | 동아리 소개, 프로젝트 목록, 캘린더 | 회원 |
| **프로젝트** | `/project/[id]` | 프로젝트 상세(포스터, 설명, 신청/관람 신청, 참여자·할일) | 역할별 차등 |
| **공개 프로젝트** | `/events`, `/events/[id]` | 전체 공개 프로젝트 목록/상세(비로그인 가능) | 전체 |
| **내 정보** | `/me`, `/me/clubs`, `/me/calendar` | 내 동아리 목록, 통합 캘린더, 알림 설정 | 로그인 유저 |
| **캘린더** | `/calendar` 또는 `/me/calendar` | 동아리별 일정 통합 뷰 | 로그인 유저 |

---

## 5. 데이터베이스 스키마 개요 (동아리 도메인 전용)

> 기존 `academies`/`users` 등은 학원용. 동아리 플랫폼은 **별도 스키마** 또는 **동일 DB 내 동아리 전용 테이블**로 구분 권장.

- **club_categories**: 대분류–중분류–소분류 (parent_id 계층).
- **clubs**: 동아리 마스터 (name, description, image_url, category_id, recruitment_open, recruitment_deadline_at, created_by, ...).
- **club_members**: 동아리–유저 관계 (club_id, user_id, role: leader/member, status: active/inactive/withdrawn, joined_at, ...).
- **club_applications**: 동아리 지원 (club_id, user_id, status, applied_at, memo, ...).
- **projects**: 프로젝트 (club_id, title, description, poster_url, visibility: club_only/private/public, project_type: paid/free/participation_fee, start_at, end_at, recruitment_deadline_at, status: scheduled/ongoing/ended, ...).
- **project_members**: 프로젝트 참여자 (project_id, user_id, role, joined_at, ...).
- **project_tasks**: 프로젝트 할일 (project_id, title, assignee_id, due_at, status, ...).
- **project_attendances** (또는 event_attendances): 관람/행사 참석 (project_id, user_id, payment_status, checked_in_at, ...).
- **schedules** (동아리용): 동아리·프로젝트 연계 일정 (club_id, project_id, title, start_at, end_at, ...).

결제는 기존 `user_payments`/`revenue_transactions` 패턴을 재사용하거나, `project_payments` 테이블로 “프로젝트(관람/참가비)” 결제만 분리할 수 있음.

---

## 6. 단계별 구현 계획

### Phase 1: 기반 및 역할·동아리 (필수)

1. **역할·인증**
   - `users`에 플랫폼 역할: `super_admin` / `club_leader` / `member` (또는 동아리별 역할은 `club_members.role`만 사용).
   - 로그인/회원가입/비밀번호 재설정 페이지.
2. **동아리 카테고리**
   - `club_categories` 테이블, 대/중/소 분류 CRUD (관리자 또는 시드).
3. **동아리 CRUD**
   - 동아리 생성·수정·삭제(리더/관리자), 목록/상세 페이지.
4. **동아리 회원·지원**
   - `club_members`, `club_applications` 테이블.
   - 모집 열기/닫기, 마감일, 지원자 목록, 수기 회원 추가.
   - 회원 상태: 활성/비활성/탈퇴.

**산출물**: 동아리 생성·목록·상세·회원/지원자 관리 화면, 기본 권한 체크.

---

### Phase 2: 프로젝트 기본 (필수)

1. **프로젝트 CRUD**
   - `projects`, `project_members` 테이블.
   - 프로젝트 타입(유가/무상/참가비), 일정, 모집 기한, 상태(예정/진행/종료).
2. **참가 신청**
   - 동아리 회원의 프로젝트 참가 신청·승인/거절(필요 시).
3. **참여 이력**
   - 프로젝트별 참여자 목록, 회원 상세에 “참여 프로젝트 목록” “최근 참여 일자”.

**산출물**: 프로젝트 생성·수정·목록·상세, 참가 신청, 참여 이력 조회.

---

### Phase 3: 할일·캘린더·공개 범위 (필수)

1. **프로젝트 할일**
   - `project_tasks` 테이블.
   - 할일 생성, 담당자 지정, 마감일, 상태.
2. **캘린더**
   - 동아리·프로젝트 연계 `schedules` (또는 기존 스키마 확장).
   - 캘린더 뷰(월/주), 동아리/프로젝트 필터.
3. **프로젝트 공개 범위**
   - visibility: 동아리만 / 비공개 / 전체공개.
   - 전체 공개 시: 포스터, 설명 본문, 공개 목록 페이지(`/events`).

**산출물**: 할일 관리 화면, 캘린더 페이지, 공개 프로젝트 목록/상세.

---

### Phase 4: 관람·결제·출석 (필수)

1. **관람 신청**
   - 전체 공개 프로젝트에 “관람 신청” (로그인/비로그인 정책 결정: 비로그인은 이메일+이름만 받기 등).
   - `project_attendances`(또는 event_attendances) 테이블.
2. **유료 관람**
   - 관람료 설정, 결제 연동(간편 결제 또는 기존 결제 플로우 재사용).
   - 결제 완료 후 관람 신청 확정.
3. **출석/입장 확인**
   - 현장 출석 체크, 입장 확인 화면(QR 또는 리스트 체크).

**산출물**: 관람 신청 폼, 결제 플로우, 출석 체크 화면.

---

### Phase 5: 회원 뷰·관리자·추가 기능 (필수 + 권장)

1. **동아리 회원 대시**
   - “내 동아리” 목록, “모집 중인 프로젝트”, “마감 임박”, “동아리 회원 모집 공고” 뷰.
2. **슈퍼관리자**
   - 전체 동아리/프로젝트/유저 관리, 프로젝트 직접 생성, 시스템 설정.
3. **알림·공지·기타**
   - 알림(마감일, 새 지원자, 관람 신청 등), 동아리 공지, (선택) 설문·자료 공유·참여 요약.

**산출물**: 회원용 대시/피드, 관리자 전용 페이지, 알림·공지 기본 구현.

---

## 7. API·권한 요약

- **인증**: Supabase Auth + Next.js 세션. 역할은 `users.role` + `club_members.role`로 판단.
- **API**:  
  - 동아리/프로젝트/회원/지원/할일/일정/관람/결제 등 REST 또는 tRPC.  
  - 각 리소스별로 “슈퍼관리자 / 해당 동아리 리더 / 해당 동아리 회원” 등 권한 체크.
- **공개 프로젝트**: 비로그인 허용 시 해당 라우트만 퍼블릭, 나머지는 인증 필수.

---

## 8. 체크리스트 — 필수 기능 누락 방지

- [ ] 슈퍼관리자 / 동아리 리더 / 동아리 회원 역할 및 권한
- [ ] 동아리 생성·정보 수정·카테고리(대·중·소)
- [ ] 동아리 회원 모집 열기/닫기, 지원 마감일, 지원자 조회, 수기 회원 추가
- [ ] 회원 상태: 활성·비활성·탈퇴
- [ ] 회원 조회 시 참여 프로젝트 목록·최근 참여 일자
- [ ] 프로젝트 생성·일정·모집 기한·참가 신청
- [ ] 예정/진행/종료 프로젝트 구분, 프로젝트별 참여자 목록
- [ ] 프로젝트 타입: 유가형·무상·참가비형
- [ ] 프로젝트 할일: 담당자·마감일
- [ ] 프로젝트 공개 범위: 동아리만/비공개/전체공개
- [ ] 전체 공개 프로젝트: 포스터·설명, 비로그인 노출, 관람 신청
- [ ] 유료 관람: 결제·관람 신청자 관리·출석/입장 확인
- [ ] 캘린더: 동아리 일정 관리·조회
- [ ] 회원 뷰: 내 동아리, 모집 중/마감 임박 프로젝트, 회원 모집 공고
- [ ] 슈퍼관리자: 전반 관리·프로젝트 직접 생성

---

이 계획서를 기준으로 아키텍트 단계에서 상세 스키마·API·타입을 정의하고, 단계별로 백엔드·프론트·QA를 진행하면 됩니다.
